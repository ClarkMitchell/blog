<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Using GitLab&#39;s pipeline with Laravel | The Viking Dev</title>
    <meta name="description" content="GitLab&#39;s pipelines can be scary at first (because you know... Docker) but they&#39;re really easy to setup and very helpful. Here&#39;s how I set up the pipelines of my Laravel applications on Gitlab.">
    <link rel="apple-touch-icon" sizes="57x57" href="/blog/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/blog/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/blog/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/blog/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/blog/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/blog/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/blog/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/blog/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/blog/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/blog/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/blog/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/blog/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/blog/favicon-16x16.png">
  <link rel="manifest" href="/blog/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
    <meta property="article:published_time" content="2018-06-03T16:33:00.000Z"><meta property="og:site_name" content="The Viking Dev"><meta property="og:title" content="Using GitLab&#39;s pipeline with Laravel"><meta property="og:description" content="GitLab&#39;s pipelines can be scary at first (because you know... Docker) but they&#39;re really easy to setup and very helpful. Here&#39;s how I set up the pipelines of my Laravel applications on Gitlab."><meta property="og:type" content="article"><meta property="og:url" content="https://theviking.dev/using-gitlabs-pipeline-with-laravel/"><meta property="og:image" content="https://theviking.dev/covers/using-gitlabs-pipeline-with-laravel.jpg"><meta name="twitter:title" content="Using GitLab&#39;s pipeline with Laravel"><meta name="twitter:description" content="GitLab&#39;s pipelines can be scary at first (because you know... Docker) but they&#39;re really easy to setup and very helpful. Here&#39;s how I set up the pipelines of my Laravel applications on Gitlab."><meta name="twitter:url" content="https://theviking.dev/using-gitlabs-pipeline-with-laravel/"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="https://theviking.dev/covers/using-gitlabs-pipeline-with-laravel.jpg"><meta name="twitter:label1" content="Written by"><meta name="twitter:data2" content="Clark Collins"><meta name="twitter:creator" content="@thevikingdev"><meta name="twitter:label2" content="Filed under"><meta name="twitter:data2" content="Laravel Lab"><meta property="article:tag" content="Laravel Lab">
    <link rel="preload" href="/blog/assets/css/0.styles.d99ab260.css" as="style"><link rel="preload" href="/blog/assets/js/app.b02e3da3.js" as="script"><link rel="preload" href="/blog/assets/js/16.70496577.js" as="script"><link rel="preload" href="/blog/assets/js/1.9159594d.js" as="script"><link rel="preload" href="/blog/assets/js/3.b7f3e871.js" as="script"><link rel="preload" href="/blog/assets/js/14.23988923.js" as="script"><link rel="preload" href="/blog/assets/js/22.aaadc110.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.3a4d6e5d.js"><link rel="prefetch" href="/blog/assets/js/11.e526cffd.js"><link rel="prefetch" href="/blog/assets/js/12.97dd4e76.js"><link rel="prefetch" href="/blog/assets/js/13.bebc3034.js"><link rel="prefetch" href="/blog/assets/js/15.42ab546a.js"><link rel="prefetch" href="/blog/assets/js/17.413a23ac.js"><link rel="prefetch" href="/blog/assets/js/18.5292ea4b.js"><link rel="prefetch" href="/blog/assets/js/19.0d345e74.js"><link rel="prefetch" href="/blog/assets/js/20.5a4e6c3e.js"><link rel="prefetch" href="/blog/assets/js/21.b4dde55d.js"><link rel="prefetch" href="/blog/assets/js/23.50b13f8e.js"><link rel="prefetch" href="/blog/assets/js/24.f446bdf5.js"><link rel="prefetch" href="/blog/assets/js/25.da4ae978.js"><link rel="prefetch" href="/blog/assets/js/26.b06a0d31.js"><link rel="prefetch" href="/blog/assets/js/27.58c189b7.js"><link rel="prefetch" href="/blog/assets/js/28.99f6a6bd.js"><link rel="prefetch" href="/blog/assets/js/29.ba7aee4a.js"><link rel="prefetch" href="/blog/assets/js/30.31845046.js"><link rel="prefetch" href="/blog/assets/js/31.e03dc770.js"><link rel="prefetch" href="/blog/assets/js/32.71d8cf23.js"><link rel="prefetch" href="/blog/assets/js/33.a1979bf1.js"><link rel="prefetch" href="/blog/assets/js/34.13272317.js"><link rel="prefetch" href="/blog/assets/js/35.657aefdb.js"><link rel="prefetch" href="/blog/assets/js/4.e03f3a74.js"><link rel="prefetch" href="/blog/assets/js/5.2411cf68.js"><link rel="prefetch" href="/blog/assets/js/6.7bdb70cf.js"><link rel="prefetch" href="/blog/assets/js/7.8a9a58e3.js"><link rel="prefetch" href="/blog/assets/js/8.1ab54f34.js"><link rel="prefetch" href="/blog/assets/js/9.2607238a.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.d99ab260.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><div><div class="h-3" style="animation:movingGradient 20s linear infinite;background-size:700% 100%;background-image:linear-gradient(120deg, #FFBE0B, #FB5607, #FF006E, #8338EC, #3A86FF, #FFBE0B, #FB5607);width:100%;transition:width .3s linear;"></div> <div class="container my-16"><div class="text-black font-serif font-semibold text-4xl md:text-5xl leading-tight mr-12 sm:mr-20 lg:mr-0">Using GitLab's pipeline with Laravel</div> <!----></div></div> <div><div class="floating-header fixed pin-x pin-t pt-2 pb-3 sm:pt-3 sm:pb-4 shadow z-floating-header"><div class="container-lg"><div class="flex items-center"><div class="flex-1 flex items-center"><a href="/blog/" class="block border-0 router-link-active"><div class="w-5 h-5"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="icon-home"><path class="primary" d="M9 22H5a1 1 0 0 1-1-1V11l8-8 8 8v10a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1v-4a1 1 0 0 0-1-1h-2a1 1 0 0 0-1 1v4a1 1 0 0 1-1 1zm3-9a2 2 0 1 0 0-4 2 2 0 0 0 0 4z"></path><path class="secondary" d="M12.01 4.42l-8.3 8.3a1 1 0 1 1-1.42-1.41l9.02-9.02a1 1 0 0 1 1.41 0l8.99 9.02a1 1 0 0 1-1.42 1.41l-8.28-8.3z"></path></svg></div></a> <div class="flex-1 font-serif font-medium ml-3 mr-4 w-5 h-5 truncate">Using GitLab's pipeline with Laravel</div></div> <div class="hidden sm:flex items-center"><div class="uppercase tracking-wide text-sm font-semibold text-grey-dark mr-3">
                    share
                </div> <a href="https://twitter.com/share?text=Using%20GitLab's%20pipeline%20with%20Laravel&amp;url=https://theviking.dev/using-gitlabs-pipeline-with-laravel/" onclick="window.open(this.href, 'share-twitter', 'width=550,height=235');return false;" class="block border-0 leading-tight text-grey-dark hover:text-blue-light mr-2"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="w-4 h-4 fill-current"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg></a> <a href="https://www.facebook.com/sharer/sharer.php?u=https://theviking.dev/using-gitlabs-pipeline-with-laravel/" onclick="window.open(this.href, 'share-facebook','width=580,height=296');return false;" class="block border-0 leading-tight text-grey-dark hover:text-blue-dark"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 264 512" class="w-4 h-4 fill-current"><path d="M215.8 85H264V3.6C255.7 2.5 227.1 0 193.8 0 124.3 0 76.7 42.4 76.7 120.3V192H0v91h76.7v229h94V283h73.6l11.7-91h-85.3v-62.7c0-26.3 7.3-44.3 45.1-44.3z"></path></svg></a></div></div></div> <div class="absolute pin-x pin-b h-1" style="animation:movingGradient 20s linear infinite;background-size:700% 100%;background-image:linear-gradient(120deg, #FFBE0B, #FB5607, #FF006E, #8338EC, #3A86FF, #FFBE0B, #FB5607);width:0%;transition:width .3s linear;"></div></div> <div class="container mb-8"><div class="flex flex-col sm:flex-row sm:items-center text-grey-darker font-semibold bg-grey-lightest border-t border-b border-grey px-4 py-2 overflow-hidden"><div class="flex flex-no-shrink items-center mb-2 sm:mb-0 sm:mr-6"><div class="w-5 h-5 flex-no-shrink"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="icon-calendar"><path class="primary" d="M5 4h14a2 2 0 0 1 2 2v13a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2zm0 5v10h14V9H5z"></path><path class="secondary" d="M7 2a1 1 0 0 1 1 1v3a1 1 0 1 1-2 0V3a1 1 0 0 1 1-1zm10 0a1 1 0 0 1 1 1v3a1 1 0 0 1-2 0V3a1 1 0 0 1 1-1z"></path></svg></div> <div class="ml-2 flex-no-shrink">03/06/2018</div></div> <div class="flex flex-no-shrink items-center"><div class="w-5 h-5 flex-no-shrink"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="icon-tag"><path class="primary" d="M2.59 13.41A1.98 1.98 0 0 1 2 12V7a5 5 0 0 1 5-5h4.99c.53 0 1.04.2 1.42.59l8 8a2 2 0 0 1 0 2.82l-8 8a2 2 0 0 1-2.82 0l-8-8zM7 9a2 2 0 1 0 0-4 2 2 0 0 0 0 4z"></path><path class="secondary" d="M12 18l6-6-4-4-6 6.01L12 18z"></path></svg></div> <div class="ml-2 flex-no-shrink">Laravel Lab</div></div></div></div> <div class="content default content__default"><h1 id="using-gitlab-s-pipeline-with-laravel"><a href="#using-gitlab-s-pipeline-with-laravel" aria-hidden="true" class="header-anchor">#</a> Using GitLab's pipeline with Laravel</h1> <p>GitLab's pipelines can be scary at first (because you know... Docker) but they're really easy to setup and very helpful. Here's how I set up the pipelines of my Laravel applications on Gitlab.</p> <h2 id="a-quick-docker-intro"><a href="#a-quick-docker-intro" aria-hidden="true" class="header-anchor">#</a> A quick docker intro</h2> <p>GitLab's pipelines contain one or several jobs. Those jobs run in complete isolation. Meaning that, every time a job is ran, a new docker container is created by mounting a docker image which is created via a DockerFile.</p> <p>I swear, it's easier than it seems. Let's go through this terminology:</p> <ul><li>Think of a <strong>docker container</strong> as the box containing your code and everything it needs (operating system, composer dependencies, etc.).</li> <li>Think of a <strong>docker image</strong> as the factory that can create as many boxes (docker containers) as your need.</li> <li>Think of a <strong>DockerFile</strong> as the blueprint responsible for describing how to create a new docker image.</li> <li>A DockerFile <strong>builds</strong> a docker image that <strong>gets mounted</strong> into docker containers.</li></ul> <p><img src="/blog/assets/img/docker-image-Step-1.56046c3d.png" alt="Docker image diagram"></p> <p>The good news is, you do not need to write your own DockerFiles. There is a place called <a href="https://hub.docker.com/" target="_blank" rel="noopener noreferrer">Docker Hub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> â€” kind of like GitHub for Docker images â€” where you can pull pre-configured docker images and build on top of that.</p> <h2 id="new-gitlab-ci-file"><a href="#new-gitlab-ci-file" aria-hidden="true" class="header-anchor">#</a> New gitlab-ci file</h2> <p>Okay let's start by creating a new file named <code>.gitlab-ci.yml</code> at the root of your application. We will configure our GitLab pipelines here.</p> <h2 id="choose-your-docker-image"><a href="#choose-your-docker-image" aria-hidden="true" class="header-anchor">#</a> Choose your docker image</h2> <p>Typically you would use an existing docker image to start with, like <code>php:latest</code> for the latest version of php. Then you'd have to manually add all of the modules and dependencies required by Laravel. GitLab has an option called <code>before_script</code> which will be called right before the start of every job. Therefore you can use it to install your required php modules, composer, etc. In your <code>.gitlab-ci.yml</code> file, it would look like that:</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">image</span><span class="token punctuation">:</span> php<span class="token punctuation">:</span>latest

<span class="token key atrule">before_script</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token comment"># Install php modules</span>
    <span class="token punctuation">-</span> <span class="token comment"># Install composer</span>
    <span class="token punctuation">-</span> <span class="token comment"># ...</span>
</code></pre></div><p>However running all of those commands for every single job is very expensive. It would be much nicer (and reduce our pipeline quota) if the mounted image already had everything that we need.</p> <p>That's why I created my own DockerFile <code>lorisleiva/laravel-docker</code> which contains all of the dependencies required by Laravel. I uploaded its image into <a href="https://hub.docker.com/r/lorisleiva/laravel-docker/" target="_blank" rel="noopener noreferrer">Docker hub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> so that we can use it directly in our pipeline configuration file.</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">image</span><span class="token punctuation">:</span> lorisleiva/laravel<span class="token punctuation">-</span>docker<span class="token punctuation">:</span>latest
</code></pre></div><p>And we're all good to go. After mounting the image, GitLab will automatically <code>clone</code> and <code>cd</code> into your repository. Now let's have fun configuring some jobs.</p> <div class="flex justify-center items-center mb-8"><a href="https://github.com/lorisleiva/laravel-docker" target="_blank" class="flex items-center rounded-lg border border-grey-darkest text-grey-darkest no-underline px-4 py-2 hover:bg-topaz hover:border-transparent hover:text-white"><svg height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024" class="fill-current mr-2"><path d="M512 0C229.25 0 0 229.25 0 512c0 226.25 146.688 418.125 350.156 485.812 25.594 4.688 34.938-11.125 34.938-24.625 0-12.188-0.469-52.562-0.719-95.312C242 908.812 211.906 817.5 211.906 817.5c-23.312-59.125-56.844-74.875-56.844-74.875-46.531-31.75 3.53-31.125 3.53-31.125 51.406 3.562 78.47 52.75 78.47 52.75 45.688 78.25 119.875 55.625 149 42.5 4.654-33 17.904-55.625 32.5-68.375C304.906 725.438 185.344 681.5 185.344 485.312c0-55.938 19.969-101.562 52.656-137.406-5.219-13-22.844-65.094 5.062-135.562 0 0 42.938-13.75 140.812 52.5 40.812-11.406 84.594-17.031 128.125-17.219 43.5 0.188 87.312 5.875 128.188 17.281 97.688-66.312 140.688-52.5 140.688-52.5 28 70.531 10.375 122.562 5.125 135.5 32.812 35.844 52.625 81.469 52.625 137.406 0 196.688-119.75 240-233.812 252.688 18.438 15.875 34.75 47 34.75 94.75 0 68.438-0.688 123.625-0.688 140.5 0 13.625 9.312 29.562 35.25 24.562C877.438 930 1024 738.125 1024 512 1024 229.25 794.75 0 512 0z"></path></svg> <span class="font-semibold font-sans text-base">See laravel-docker on GitHub</span></a></div> <h2 id="running-our-test-suite"><a href="#running-our-test-suite" aria-hidden="true" class="header-anchor">#</a> Running our test suite</h2> <p>The first job I'd like to set up, is simply one that runs all of our tests. This job will be successful if and only if all tests are passing. This should be as easy as:</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token comment"># This is the name of our job, call it whatever you want.</span>
<span class="token key atrule">phpunit</span><span class="token punctuation">:</span>

    <span class="token comment"># This is used to categorize jobs. Jobs within the same stage are run in parallel.</span>
    <span class="token key atrule">stage</span><span class="token punctuation">:</span> test
    
    <span class="token comment"># This is the list of commands executed by the job.</span>
    <span class="token key atrule">script</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> phpunit <span class="token punctuation">-</span><span class="token punctuation">-</span>coverage<span class="token punctuation">-</span>text <span class="token punctuation">-</span><span class="token punctuation">-</span>colors=never
</code></pre></div><p>However this is not going to work because our Laravel application is missing its <code>vendor</code> folder, its <code>.env</code> file and thus its encryption key. So before running our tests we need to make sure our application is initialized properly.</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">phpunit</span><span class="token punctuation">:</span>
    <span class="token key atrule">stage</span><span class="token punctuation">:</span> test
    <span class="token key atrule">script</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> composer install <span class="token punctuation">-</span><span class="token punctuation">-</span>prefer<span class="token punctuation">-</span>dist <span class="token punctuation">-</span><span class="token punctuation">-</span>no<span class="token punctuation">-</span>ansi <span class="token punctuation">-</span><span class="token punctuation">-</span>no<span class="token punctuation">-</span>interaction <span class="token punctuation">-</span><span class="token punctuation">-</span>no<span class="token punctuation">-</span>progress <span class="token punctuation">-</span><span class="token punctuation">-</span>no<span class="token punctuation">-</span>scripts
        <span class="token punctuation">-</span> cp .env.example .env
        <span class="token punctuation">-</span> php artisan key<span class="token punctuation">:</span>generate
        <span class="token punctuation">-</span> phpunit <span class="token punctuation">-</span><span class="token punctuation">-</span>coverage<span class="token punctuation">-</span>text <span class="token punctuation">-</span><span class="token punctuation">-</span>colors=never
</code></pre></div><p><small>Note that these commands can only be ran once our Laravel application has been cloned and therefore cannot be added to our DockerFile: <code>lorisleiva/laravel-docker</code>.</small></p> <p>And that's it. Now every time you commit into your master branch, GitLab will start the <code>phpunit</code> job letting you know of its status via a little pass or fail icon.</p> <p><img src="/blog/assets/img/Screen-Shot-2018-06-03-at-17.03.04.0680dd5c.png" alt="GitLab success and fail pipeline icon"></p> <h2 id="checking-our-code-style"><a href="#checking-our-code-style" aria-hidden="true" class="header-anchor">#</a> Checking our code style</h2> <p>Another nice job to implement is checking your code for some code style violations. Our docker image already contains the <code>PHP_CodeSniffer</code> pear extension. Thus all you need to do is run <code>phpcs</code>.</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">codestyle</span><span class="token punctuation">:</span>

    <span class="token comment"># Let's run that in parallel with phpunit.</span>
    <span class="token key atrule">stage</span><span class="token punctuation">:</span> test
    
    <span class="token key atrule">script</span><span class="token punctuation">:</span>
        <span class="token comment"># We'll comply with the PSR2 standard and check all .php file in our app folder.</span>
        <span class="token punctuation">-</span> phpcs <span class="token punctuation">-</span><span class="token punctuation">-</span>standard=PSR2 <span class="token punctuation">-</span><span class="token punctuation">-</span>extensions=php app
</code></pre></div><h2 id="caching-our-vendors"><a href="#caching-our-vendors" aria-hidden="true" class="header-anchor">#</a> Caching our vendors</h2> <p>You might have noticed that, so far, every time a <code>phpunit</code> job runs, composer installs all of the dependencies from scratch. We can improve the performance of our pipelines by caching and sharing the <code>vendor</code> folder across all of the commits of one branch.</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">cache</span><span class="token punctuation">:</span>

    <span class="token comment"># We key the cache using the branch's unique identifier.</span>
    <span class="token key atrule">key</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span>CI_COMMIT_REF_SLUG<span class="token punctuation">}</span>
    
    <span class="token key atrule">paths</span><span class="token punctuation">:</span>
        <span class="token comment"># We only want to cache the vendor folder.</span>
        <span class="token punctuation">-</span> vendor/
</code></pre></div><p>This will cache and share the <code>vendor</code> folder across all of our jobs. However our <code>codestyle</code> job does not need any composer dependencies and therefore does not need the <code>vendor</code> folder altogether. We can disable the cache for one particular job like so:</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">codestyle</span><span class="token punctuation">:</span>
    <span class="token key atrule">stage</span><span class="token punctuation">:</span> test
    <span class="token key atrule">cache</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment"># Override with an empty object.</span>
    <span class="token key atrule">script</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> phpcs <span class="token punctuation">-</span><span class="token punctuation">-</span>standard=PSR2 <span class="token punctuation">-</span><span class="token punctuation">-</span>extensions=php app
</code></pre></div><h2 id="conclusion"><a href="#conclusion" aria-hidden="true" class="header-anchor">#</a> Conclusion</h2> <p>As you can see on the diagram below, GitLab allows us to abstract the complexity of docker behind a simple configuration file.</p> <p><img src="/blog/assets/img/docker-image-Step-2.45d9f85e.png" alt="Docker image diagram summary"></p> <p>There is a lot more that can be done but this should help you getting started with GitLab's pipelines for your Laravel applications. Feel free to share your job ideas here and I might write a little series of articles that will help you improve your CI/CD.</p> <div class="flex justify-center items-center mb-8"><a href="https://github.com/lorisleiva/laravel-docker/blob/master/gitlab/.gitlab-ci.tests.yml" target="_blank" class="flex items-center rounded-lg border border-grey-darkest text-grey-darkest no-underline px-4 py-2 hover:bg-topaz hover:border-transparent hover:text-white"><svg height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024" class="fill-current mr-2"><path d="M512 0C229.25 0 0 229.25 0 512c0 226.25 146.688 418.125 350.156 485.812 25.594 4.688 34.938-11.125 34.938-24.625 0-12.188-0.469-52.562-0.719-95.312C242 908.812 211.906 817.5 211.906 817.5c-23.312-59.125-56.844-74.875-56.844-74.875-46.531-31.75 3.53-31.125 3.53-31.125 51.406 3.562 78.47 52.75 78.47 52.75 45.688 78.25 119.875 55.625 149 42.5 4.654-33 17.904-55.625 32.5-68.375C304.906 725.438 185.344 681.5 185.344 485.312c0-55.938 19.969-101.562 52.656-137.406-5.219-13-22.844-65.094 5.062-135.562 0 0 42.938-13.75 140.812 52.5 40.812-11.406 84.594-17.031 128.125-17.219 43.5 0.188 87.312 5.875 128.188 17.281 97.688-66.312 140.688-52.5 140.688-52.5 28 70.531 10.375 122.562 5.125 135.5 32.812 35.844 52.625 81.469 52.625 137.406 0 196.688-119.75 240-233.812 252.688 18.438 15.875 34.75 47 34.75 94.75 0 68.438-0.688 123.625-0.688 140.5 0 13.625 9.312 29.562 35.25 24.562C877.438 930 1024 738.125 1024 512 1024 229.25 794.75 0 512 0z"></path></svg> <span class="font-semibold font-sans text-base">Full code on GitHub</span></a></div> <p><em>Edit 12/06/2018:</em> Learn how to use GitLab's pipeline to build, test and deploy your Laravel applications in my <a href="/laravel-deployment-using-gitlab-pipelines">next article</a>.</p></div> <div class="bg-grey-lighter mt-16"><div class="container py-4 sm:py-8"><h2>Related articles</h2> <div class="flex flex-wrap -mx-5"><a href="/blog/introducing-javel/" class="article-card relative flex flex-col rounded-lg shadow-xl hover:shadow-2xl min-h-article-card border-0 z-article-card mx-5 mb-8"><figure><div class="h-48 rounded-t-lg bg-no-repeat bg-cover bg-center" style="background-image:url(/covers/introducing-javel.png);"></div></figure> <main class="flex flex-1 flex-col bg-white rounded-b-lg p-6"><header><div class="uppercase tracking-wide text-grey-dark text-sm font-semibold">Vue Lab</div> <div class="font-sans text-2xl mb-4 border-0 leading-tight text-black font-semibold">Introducing Javel</div></header> <section class="font-content text-lg text-grey-darker">Wrap your plain JavaScript objects into customizable Laravel-like models.</section></main> <div class="ribbon river"><span>popular</span></div></a><a href="/blog/google-calendar-part-2-periodic-synchronizations/" class="article-card relative flex flex-col rounded-lg shadow-xl hover:shadow-2xl min-h-article-card border-0 z-article-card mx-5 mb-8"><figure><div class="h-48 rounded-t-lg bg-no-repeat bg-cover bg-center" style="background-image:url(/covers/google-calendar-part-2-periodic-synchronizations.jpg);"></div></figure> <main class="flex flex-1 flex-col bg-white rounded-b-lg p-6"><header><div class="uppercase tracking-wide text-grey-dark text-sm font-semibold">Laravel Lab</div> <div class="font-sans text-2xl mb-4 border-0 leading-tight text-black font-semibold">Google Calendar part 2: Periodic synchronizations</div></header> <section class="font-content text-lg text-grey-darker">Learn how to periodically synchronize your users' calendars and events from the Google API.</section></main> <!----></a></div></div></div></div> <div class="bg-grey-darkest text-white"><div class="container py-8 flex"><div class="flex-1">
                Find me elsewhere ðŸ‘‰
            </div> <div class="-mx-2"><a href="https://twitter.com/TheVikingDev" class="text-white hover:text-blue-light border-0 mx-2"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="w-5 h-5 fill-current"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg></a> <a href="https://github.com/ClarkMitchell" class="text-white hover:text-grey border-0 mx-2"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512" class="w-5 h-5 fill-current"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a></div></div></div></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.b02e3da3.js" defer></script><script src="/blog/assets/js/16.70496577.js" defer></script><script src="/blog/assets/js/1.9159594d.js" defer></script><script src="/blog/assets/js/3.b7f3e871.js" defer></script><script src="/blog/assets/js/14.23988923.js" defer></script><script src="/blog/assets/js/22.aaadc110.js" defer></script>
  </body>
</html>
